/**
 * skylark-io-streams - The stream features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,e){var r=e.define,require=e.require,n="function"==typeof r&&r.amd,s=!n&&"undefined"!=typeof exports;if(!n&&!r){var i={};r=e.define=function(t,e,r){"function"==typeof r?(i[t]={factory:r,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var r=e.split("/"),n=t.split("/");r.pop();for(var s=0;s<n.length;s++)"."!=n[s]&&(".."==n[s]?r.pop():r.push(n[s]));return r.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):i[t]={factory:null,resolved:!0,exports:r}},require=e.require=function(t){if(!i.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=i[t];if(!module.resolved){var r=[];module.deps.forEach(function(t){r.push(require(t))}),module.exports=module.factory.apply(e,r)||null,module.resolved=!0}return module.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-langx-ns/_attach",[],function(){return function(t,e,r){"string"==typeof e&&(e=e.split("."));for(var n=e.length,s=t,i=0,a=e[i++];i<n;)s=s[a]=s[a]||{},a=e[i++];if(s[a]){if(r)throw new Error("This namespace already exists:"+e)}else s[a]=r||{};return s[a]}}),t("skylark-langx-ns/ns",["./_attach"],function(t){var e={attach:function(r,n){return t(e,r,n)}};return e}),t("skylark-langx-ns/main",["./ns"],function(t){return t}),t("skylark-langx-ns",["skylark-langx-ns/main"],function(t){return t}),t("skylark-io-streams/streams",["skylark-langx-ns"],function(t){return t.attach("io.streams")}),t("skylark-langx-types/types",["skylark-langx-ns"],function(t){var e,r=Array.isArray,n={}.toString,s=(e={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(t){e["[object "+t+"]"]=t.toLowerCase()}),function(t){return null==t?String(t):e[n.call(t)]||"object"}),i=r||function(t){return object&&object.constructor===Array};function a(t){var e;for(e in t)if(null!==t[e])return!1;return!0}function o(t){return"function"==s(t)}function u(t){return t&&t.nodeType}function l(t){return"number"==typeof t}function c(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function f(t){return"string"==typeof t}function h(t){return t&&t==t.window}function y(t){return"symbol"==typeof t}var g=1/0,k=1.7976931348623157e308,p=NaN,d=/^\s+|\s+$/g,m=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,b=/^0o[0-7]+$/i,x=parseInt;function w(t){if(!t)return 0===t?t:0;if((t=B(t))===g||t===-g){var e=t<0?-1:1;return e*k}return t==t?t:0}function B(t){if("number"==typeof t)return t;if(y(t))return p;if(c(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=c(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(d,"");var r=v.test(t);return r||b.test(t)?x(t.slice(2),r?2:8):m.test(t)?p:+t}return t.attach("langx.types",{isArray:i,isArrayLike:function(t){return!f(t)&&!u(t)&&"number"==typeof t.length&&!o(t)},isBoolean:function(t){return!0===t||!1===t||"[object Boolean]"===n.call(t)},isDefined:function(t){return void 0!==t},isDocument:function(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE},isElement:function(t){return!(!t||1!==t.nodeType)},isEmpty:a,isEmptyObject:a,isFunction:o,isHtmlNode:u,isInstanceOf:function(t,e){return void 0!==t&&(null===t||e==Object||("number"==typeof t?e===Number:"string"==typeof t?e===String:"boolean"==typeof t?e===Boolean:"string"==typeof t?e===String:t instanceof e||!(!t||!t.isInstanceOf)&&t.isInstanceOf(e)))},isNaN:function(t){return isNaN(t)},isNull:function(t){return null===t},isNumber:l,isNumeric:l,isObject:c,isPlainObject:function(t){return c(t)&&!h(t)&&Object.getPrototypeOf(t)==Object.prototype},isString:f,isSameOrigin:function(t){if(t){var e=location.protocol+"//"+location.hostname;return location.port&&(e+=":"+location.port),t.startsWith(e)}},isSymbol:y,isUndefined:function(t){return void 0===t},isWindow:h,type:s,toFinite:w,toNumber:B,toInteger:function(t){var e=w(t),r=e%1;return e==e?r?e-r:e:0}})}),t("skylark-langx-types/main",["./types"],function(t){return t}),t("skylark-langx-types",["skylark-langx-types/main"],function(t){return t}),t("skylark-langx-chars/chars",["skylark-langx-ns","skylark-langx-types"],function(t,e){return t.attach("langx.chars",{isWhiteSpace:function(t){return 32===t||9===t||13===t||10===t}})}),t("skylark-langx-chars/main",["./chars"],function(t){return t}),t("skylark-langx-chars",["skylark-langx-chars/main"],function(t){return t}),t("skylark-langx-events/events",["skylark-langx-ns"],function(t){return t.attach("langx.events",{})}),t("skylark-langx-objects/objects",["skylark-langx-ns","skylark-langx-types"],function(t,e){return t.attach("langx.objects",{attach:t.attach})}),t("skylark-langx-objects/all-keys",["skylark-langx-types","./objects"],function(t,e){return e.allKeys=function(e){if(!t.isObject(e))return[];var r=[];for(var n in e)r.push(n);return r}}),t("skylark-langx-objects/assign",["skylark-langx-types","./objects"],function(t,e){return e.assign=Object.assign}),t("skylark-langx-objects/to-key",["skylark-langx-types","./objects"],function(t,e){const r=t.isSymbol,n=t.isString,s=1/0;return e.toKey=function(t){if(n(t)||r(t))return t;const e=`${t}`;return"0"==e&&1/t==-s?"-0":e}}),t("skylark-langx-objects/is-key",["skylark-langx-types","./objects"],function(t,e){const r=t.isSymbol,n=t.isArray,s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;return e.isKey=function(t,e){if(n(t))return!1;const a=typeof t;if("number"===a||"boolean"===a||null==t||r(t))return!0;return i.test(t)||!s.test(t)||null!=e&&t in Object(e)}}),t("skylark-langx-objects/_cast_path",["skylark-langx-types","./objects","./is-key"],function(t,e,r){const n=".".charCodeAt(0),s=/\\(\\)?/g,i=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g"),a=t=>{const e=[];return t.charCodeAt(0)===n&&e.push(""),t.replace(i,(t,r,n,i)=>{let a=t;n?a=i.replace(s,"$1"):r&&(a=r.trim()),e.push(a)}),e};return function(e,n){if(t.isArray(e))return e;return r(e,n)?[e]:a(e)}}),t("skylark-langx-objects/get",["skylark-langx-types","./objects","./to-key","./_cast_path"],function(t,e,r,n){return e.get=function(t,e,s){const i=null==t?void 0:function(t,e){let s=0;const i=(e=n(e,t)).length;for(;null!=t&&s<i;)t=t[r(e[s++])];return s&&s==i?t:void 0}(t,e);return void 0===i?s:i}}),t("skylark-langx-objects/base-at",["./objects","./get"],function(t,e){return t.baseAt=function(t,r){let n=-1;const s=r.length,i=new Array(s),a=null==t;for(;++n<s;)i[n]=a?void 0:e(t,r[n]);return i}}),t("skylark-langx-objects/clone",["skylark-langx-types","./objects"],function(t,e){var r=t.isPlainObject,n=t.isArray;return e.clone=function t(e,s){var i;if(void 0===e||null===e)i=e;else if(s&&e.clone)i=e.clone();else if(n(e)){i=[];for(var a=0;a<e.length;a++)i.push(t(e[a]))}else if(r(e))for(var o in i={},e)i[o]=t(e[o]);else i=e;return i}}),t("skylark-langx-objects/defaults",["./objects","./all-keys"],function(t,e){return t.defaults=(r=e,n=!0,function(t){var e=arguments.length;if(n&&(t=Object(t)),e<2||null==t)return t;for(var s=1;s<e;s++)for(var i=arguments[s],a=r(i),o=a.length,u=0;u<o;u++){var l=a[u];n&&void 0!==t[l]||(t[l]=i[l])}return t});var r,n}),t("skylark-langx-objects/each",["./objects"],function(t){return t.each=function(t,e,r){var n,s,i,a;if(t)if(void 0===(n=t.length)){for(s in t)if(t.hasOwnProperty(s)&&(a=t[s],!1===(r?e.call(a,a,s):e.call(a,s,a))))break}else for(i=0;i<n&&(a=t[i],!1!==(r?e.call(a,a,i):e.call(a,i,a)));i++);return this}}),t("skylark-langx-objects/_mixin",["skylark-langx-types","./objects"],function(t,e){var r=t.isPlainObject;return function t(e,n,s,i){for(var a in n)i&&void 0!==e[a]||(s&&r(n[a])?(r(e[a])||(e[a]={}),t(e[a],n[a],s,i)):void 0!==n[a]&&(e[a]=n[a]));return e}}),t("skylark-langx-objects/_parse_mixin_args",["skylark-langx-types","./objects"],function(t,e){var r=Array.prototype.slice,n=t.isBoolean;return function(t){var e=r.call(arguments,0),s=e.shift(),i=!1;n(e[e.length-1])&&(i=e.pop());return{target:s,sources:e,deep:i}}}),t("skylark-langx-objects/mixin",["skylark-langx-types","./objects","./_mixin","./_parse_mixin_args"],function(t,e,r,n){return e.mixin=function(){var t=n.apply(this,arguments);return t.sources.forEach(function(e){r(t.target,e,t.deep,!1)}),t.target}}),t("skylark-langx-objects/extend",["./objects","./mixin"],function(t,e){var r=Array.prototype.slice;return t.extend=function(t){var n,s=r.call(arguments,1);"boolean"==typeof t&&(n=t,t=s.shift());0==s.length&&(s=[t],t=this);return s.forEach(function(r){e(t,r,n)}),t}}),t("skylark-langx-objects/for-each",["./objects","./each"],function(t,e){return t.forEach=function(t,r){if(!t)return;t.forEach?t.forEach(r):e(t,r,!0)}}),t("skylark-langx-objects/has",["skylark-langx-types","./objects"],function(t,e){var r=Object.prototype.hasOwnProperty;return e.has=function(e,n){if(!t.isArray(n))return null!=e&&r.call(e,n);for(var s=n.length,i=0;i<s;i++){var a=n[i];if(null==e||!r.call(e,a))return!1;e=e[a]}return!!s}}),t("skylark-langx-objects/includes",["./objects"],function(t){return t.includes=function(t,e,r,n){t=isArrayLike(t)?t:values(t),r=r&&!n?toInteger(r):0;var s=t.length;r<0&&(r=nativeMax(s+r,0));return isString(t)?r<=s&&t.indexOf(e,r)>-1:!!s&&baseIndexOf(t,e,r)>-1}}),t("skylark-langx-objects/is-equal",["skylark-langx-types","./objects"],function(t,e){var r,n,s=t.isFunction,i="undefined"!=typeof Symbol?Symbol.prototype:null;return r=function(t,e,r,s){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&n(t,e,r,s)},n=function(t,e,n,a){var o=toString.call(t);if(o!==toString.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return i.valueOf.call(t)===i.valueOf.call(e)}var u="[object Array]"===o;if(!u){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,c=e.constructor;if(l!==c&&!(s(l)&&l instanceof l&&s(c)&&c instanceof c)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],a=a||[];for(var f=n.length;f--;)if(n[f]===t)return a[f]===e;if(n.push(t),a.push(e),u){if((f=t.length)!==e.length)return!1;for(;f--;)if(!r(t[f],e[f],n,a))return!1}else{var h,y=Object.keys(t);if(f=y.length,Object.keys(e).length!==f)return!1;for(;f--;)if(h=y[f],void 0===e[h]||!r(t[h],e[h],n,a))return!1}return n.pop(),a.pop(),!0},e.isEqual=function(t,e){return r(t,e)}}),t("skylark-langx-objects/keys",["skylark-langx-types","./objects","./has"],function(t,e,r){return e.keys=function(e){if(!t.isObject(e))return[];var n=[];for(var s in e)r(e,s)&&n.push(s);return n}}),t("skylark-langx-objects/is-match",["skylark-langx-types","./objects","./keys"],function(t,e,r){return e.isMatch=function(t,e){var r=r(e),n=r.length;if(null==t)return!n;for(var s=Object(t),i=0;i<n;i++){var a=r[i];if(e[a]!==s[a]||!(a in s))return!1}return!0}}),t("skylark-langx-objects/omit",["./objects","./mixin"],function(t,e){return t.omit=function(t,r,n){if(!t)return null;for(var s=e({},t),i=1;i<arguments.length;i++){var a=arguments[i];a in t&&delete s[a]}return s}}),t("skylark-langx-objects/pick",["./objects"],function(t){return t.pick=function(t,e,r){if(!t)return null;for(var n={},s=1;s<arguments.length;s++){var i=arguments[s];i in t&&(n[i]=t[i])}return n}}),t("skylark-langx-objects/remove-items",["skylark-langx-types","./objects"],function(t,e){return e.removeItem=function(e,r){if(t.isArray(e)){var n=e.indexOf(r);-1!=n&&e.splice(n,1)}else if(t.isPlainObject(e))for(var s in e)if(e[s]==r){delete e[s];break}return this}}),t("skylark-langx-objects/result",["skylark-langx-types","./objects","./to-key","./_cast_path"],function(t,e,r,n){t.isArray;var s=t.isFunction;return e.result=function(t,e,i){let a=-1,o=(e=n(e,t)).length;o||(o=1,t=void 0);for(;++a<o;){let n=null==t?void 0:t[r(e[a])];void 0===n&&(a=o,n=i),t=s(n)?n.call(t):n}return t}}),t("skylark-langx-objects/safe-mixin",["./objects","./_mixin","./_parse_mixin_args"],function(t,e,r){return t.safeMixin=function(){var t=r.apply(this,arguments);return t.sources.forEach(function(r){e(t.target,r,t.deep,!0)}),t.target}}),t("skylark-langx-objects/scall",["./objects"],function(t){const e=Array.prototype.slice;return t.scall=function(t,r,n,s){if(t&&t[r]){var i=e.call(arguments,2);return t[r].apply(t,i)}}}),t("skylark-langx-objects/is-index",["skylark-langx-types","./objects"],function(t,e){const r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;return e.isIndex=function(t,e){const s=typeof t;return!!(e=null==e?r:e)&&("number"===s||"symbol"!==s&&n.test(t))&&t>-1&&t%1==0&&t<e}}),t("skylark-langx-objects/set",["skylark-langx-types","./objects","./_cast_path","./is-index","./to-key"],function(t,e,r,n,s){return e.set=function(e,i,a){return null==e?e:function(e,i,a,o){if(!t.isObject(e))return e;const u=(i=r(i,e)).length,l=u-1;let c=-1,f=e;for(;null!=f&&++c<u;){const e=s(i[c]);let r=a;if(c!=l){const s=f[e];void 0===(r=o?o(s,e,f):void 0)&&(r=t.isObject(s)?s:n(i[c+1])?[]:{})}f[e]=r,f=f[e]}return e}(e,i,a)}}),t("skylark-langx-objects/shadow",["./objects"],function(t){return t.shadow=function(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!1}),r}}),t("skylark-langx-objects/unset",["skylark-langx-types","./objects","./set"],function(t,e,r){return e.unset=function(t,e){return null==t||r(t,e,void 0)}}),t("skylark-langx-objects/values",["skylark-langx-types","./objects","./all-keys"],function(t,e,r){return e.values=function(t){for(var e=r(t),n=e.length,s=Array(n),i=0;i<n;i++)s[i]=t[e[i]];return s}}),t("skylark-langx-objects/main",["./objects","./all-keys","./assign","./base-at","./clone","./defaults","./each","./extend","./for-each","./get","./has","./includes","./is-equal","./is-key","./is-match","./keys","./mixin","./omit","./pick","./remove-items","./result","./safe-mixin","./scall","./set","./shadow","./to-key","./unset","./values"],function(t){return t}),t("skylark-langx-objects",["skylark-langx-objects/main"],function(t){return t}),t("skylark-langx-funcs/funcs",["skylark-langx-ns"],function(t,e,r){return t.attach("langx.funcs",{noop:function(){},returnTrue:function(){return!0},returnFalse:function(){return!1}})}),t("skylark-langx-funcs/rest-arguments",["./funcs"],function(t){return t.restArguments=function(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),s=0;s<r;s++)n[s]=arguments[s+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var i=Array(e+1);for(s=0;s<e;s++)i[s]=arguments[s];return i[e]=n,t.apply(this,i)}}}),t("skylark-langx-funcs/bind-all",["./funcs","./rest-arguments"],function(t,e){return t.bindAll=e(function(t,e){var r=e.length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=e[r];t[n]=t[n].bind(t)}})}),t("skylark-langx-funcs/defer",["skylark-langx-types","./funcs"],function(t,e){return e.defer=function(e,r,n,s){var i={cancel:null},a=e;t.isNumber(r)||t.isFunction(r)||(s=n,n=r,r=0);n&&(a=function(){e.apply(s,n)});if(t.isFunction(r)){var o=!1;r(function(){o||a()}),i.cancel=function(){o=!0}}else{var u;0==r&&requestAnimationFrame?(u=requestAnimationFrame(a),i.cancel=function(){return cancelAnimationFrame(u)}):(u=setTimeout(a,r),i.cancel=function(){return clearTimeout(u)})}return i}}),t("skylark-langx-funcs/debounce",["./funcs","./defer"],function(t,e){return t.debounce=function(t,r,n){var s,i,a=function(){var a=this,u=arguments;return o(),s=setTimeout(function(){s=null,n?i=e(t,u,a):t.apply(a,u)},r),{cancel:o}},o=a.cancel=function(){s&&clearTimeout(s),i&&i.cancel(),s=void 0,i=void 0};return a}}),t("skylark-langx-funcs/delegate",["skylark-langx-objects","./funcs"],function(t,e){var r=t.mixin,n=function(){function t(){}return function(e,n){t.prototype=e;var s=new t;return t.prototype=null,n&&r(s,n),s}}();return e.delegate=n}),t("skylark-langx-funcs/loop",["./funcs"],function(t){function e(t){this.callback=t,this.running=!1,this.id=-1}return e.prototype.start=function(){if(!this.running){this.running=!0;var t=this;!function e(){t.callback();t.running&&(t.id=requestAnimationFrame(e))}()}},e.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},t.loop=function(t){return new e(t)}}),t("skylark-langx-funcs/negate",["./funcs"],function(t){return t.negate=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(...e){return!t.apply(this,e)}}}),t("skylark-langx-funcs/proxy",["skylark-langx-types","./funcs"],function(t,e){var r=Array.prototype.slice,n=t.isFunction,s=t.isString;return e.bind=e.proxy=function t(e,i){var a=2 in arguments&&r.call(arguments,2);if(n(e)){return function(){return e.apply(i,a?a.concat(r.call(arguments)):arguments)}}if(s(i))return a?(a.unshift(e[i],e),t.apply(null,a)):t(e[i],e);throw new TypeError("expected function")}}),t("skylark-langx-funcs/template",["skylark-langx-objects","./funcs","./proxy"],function(t,e,r){Array.prototype.slice;var n={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},s=/(.)^/,i={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},a=/\\|'|\r|\n|\t|\u2028|\u2029/g;function o(e,o){var u;o=t.defaults({},o,n);var l=RegExp([(o.escape||s).source,(o.interpolate||s).source,(o.evaluate||s).source].join("|")+"|$","g"),c=0,f="__p+='";e.replace(l,function(t,r,n,s,o){return f+=e.slice(c,o).replace(a,function(t){return"\\"+i[t]}),r&&(f+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),n&&(f+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(f+="';\n"+s+"\n__p+='"),c=o+t.length,t}),f+="';\n",o.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{u=new Function(o.variable||"obj","_",f)}catch(t){throw t.source=f,t}var h=r(function(t){return u.call(this,t,this)},this),y=o.variable||"obj";return h.source="function("+y+"){\n"+f+"}",h}return o.templateSettings=e.templateSettings=n,e.template=o}),t("skylark-langx-funcs/throttle",["./funcs"],function(t){return t.throttle=function(t,e){let r=window.performance.now();return function(...n){const s=window.performance.now();s-r>=e&&(t(...n),r=s)}}}),t("skylark-langx-funcs/main",["./funcs","./bind-all","./debounce","./defer","./delegate","./loop","./negate","./proxy","./rest-arguments","./template","./throttle"],function(t){return t}),t("skylark-langx-funcs",["skylark-langx-funcs/main"],function(t){return t}),t("skylark-langx-constructs/constructs",["skylark-langx-ns"],function(t){return t.attach("langx.constructs",{})}),t("skylark-langx-constructs/inherit",["./constructs"],function(t){return t.inherit=function(t,e){if("function"!=typeof e&&e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object.setPrototypeOf(t,e)}}),t("skylark-langx-arrays/arrays",["skylark-langx-ns"],function(t){return t.attach("langx.arrays")}),t("skylark-langx-arrays/base-find-index",["./arrays"],function(t){return t.baseFindIndex=function(t,e,r,n){var s=t.length,i=r+(n?1:-1);for(;n?i--:++i<s;)if(e(t[i],i,t))return i;return-1}}),t("skylark-langx-arrays/base-indexof",["./arrays","./base-find-index"],function(t,e){function r(t){return t!=t}return t.baseIndexOf=function(t,n,s){if(n!=n)return e(t,r,s);var i=s-1,a=t.length;for(;++i<a;)if(t[i]===n)return i;return-1}}),t("skylark-langx-arrays/filter",["./arrays"],function(t){var e=Array.prototype.filter;return t.filter=function(t,r){return e.call(t,r)}}),t("skylark-langx-arrays/compact",["./arrays","./filter"],function(t,e){return t.compact=function(t){return e(t,function(t){return null!=t})}}),t("skylark-langx-arrays/in-array",["./arrays"],function(t){return t.inArray=function(t,e){if(!e)return-1;var r;if(e.indexOf)return e.indexOf(t);r=e.length;for(;r--;)if(e[r]===t)return r;return-1}}),t("skylark-langx-arrays/contains",["./arrays","./in-array"],function(t,e){return t.contains=function(t,r){return e(r,t)}}),t("skylark-langx-arrays/flatten",["skylark-langx-types","./arrays"],function(t,e){return e.flatten=function(e){if(t.isArrayLike(e)){for(var r=[],n=0;n<e.length;n++){var s=e[n];if(t.isArrayLike(s))for(var i=0;i<s.length;i++)r.push(s[i]);else r.push(s)}return r}return e}}),t("skylark-langx-arrays/difference",["skylark-langx-funcs","./arrays","./flatten","./filter","./contains"],function(t,e,r,n,s){var i=t.restArguments(function(t,e){return e=r(e,!0,!0),n(t,function(t){return!s(e,t)})});return e.difference=i}),t("skylark-langx-arrays/find",["./arrays"],function(t){var e=Array.prototype.find;return t.find=function(t,r){return e.call(t,r)}}),t("skylark-langx-arrays/first",["./arrays"],function(t){return t.first=function(t,e){return e?t.slice(0,e):t[0]}}),t("skylark-langx-arrays/grep",["skylark-langx-objects","./arrays"],function(t,e){return e.grep=function(e,r){var n=[];return t.each(e,function(t,e){r(e,t)&&n.push(e)}),n}}),t("skylark-langx-arrays/indexof",["./arrays"],function(t){return t.indexOf=function(t,e){return t.indexOf(e)}}),t("skylark-langx-arrays/last",["./arrays"],function(t){return t.last=function(t){return t[t.length-1]}}),t("skylark-langx-arrays/make-array",["skylark-langx-types","./arrays"],function(t,e){return e.makeArray=function(e,r,n){if(t.isArrayLike(e))return(n||[]).concat(Array.prototype.slice.call(e,r||0));return[e]}}),t("skylark-langx-arrays/map",["skylark-langx-types","./arrays","./flatten"],function(t,e,r){return e.map=function(e,n){var s,i,a,o=[];if(t.isArrayLike(e))for(i=0;i<e.length;i++)null!=(s=n.call(e[i],e[i],i))&&o.push(s);else for(a in e)null!=(s=n.call(e[a],e[a],a))&&o.push(s);return r(o)}}),t("skylark-langx-arrays/merge",["./arrays"],function(t){return t.merge=function(t,e){var r=e.length,n=t.length,s=0;if("number"==typeof r)for(;s<r;s++)t[n++]=e[s];else for(;void 0!==e[s];)t[n++]=e[s++];return t.length=n,t}}),t("skylark-langx-arrays/pull-at",["skylark-langx-types","skylark-langx-objects","./arrays"],function(t,e,r){return r.pullAt=function(t,...r){null==t||t.length;const n=e.baseAt(t,r);r.sort(function(t,e){return t-e});for(let e=r.length-1;e>=0;e--)t.slice(r[e],1);return n}}),t("skylark-langx-arrays/reduce",["./arrays"],function(t){return t.reduce=function(t,e,r){return Array.prototype.reduce.call(t,e,r)}}),t("skylark-langx-arrays/uniq",["./arrays","./filter"],function(t,e){return t.uniq=function(t){return e(t,function(e,r){return t.indexOf(e)==r})}}),t("skylark-langx-arrays/without",["skylark-langx-funcs","./arrays","./difference"],function(t,e,r){var n=t.restArguments(function(t,e){return r(t,e)});return e.without=n}),t("skylark-langx-arrays/main",["./arrays","./base-find-index","./base-indexof","./compact","./contains","./difference","./filter","./find","./first","./flatten","./grep","./in-array","./indexof","./last","./make-array","./map","./merge","./pull-at","./reduce","./uniq","./without"],function(t){return t}),t("skylark-langx-arrays",["skylark-langx-arrays/main"],function(t){return t}),t("skylark-langx-constructs/klass",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","./constructs","./inherit"],function(t,e,r,n,s,i){var a=n.uniq,o=r.has,u=r.mixin,l=e.isArray,c=e.isDefined,f=function(){function t(){return this._construct?this._construct.apply(this,arguments):this.init?this.init.apply(this,arguments):void 0}return function r(n,s,f,h){l(s)&&(h=f,f=s,s=null),s=s||Object,c(f)&&!l(f)&&(h=f,f=!1);var y=s;f&&(f=function(t,e){var r=[];return e.forEach(function(t){if(o(t,"__mixins__"))throw new Error("nested mixins");for(var e=[];t;)e.unshift(t),t=t.superclass;r=r.concat(e)}),(r=(r=a(r)).filter(function(e){for(var r=t;r;){if(e===r)return!1;if(o(r,"__mixins__"))for(var n=r.__mixins__,s=0;s<n.length;s++)if(n[s]===e)return!1;r=r.superclass}return!0})).length>0&&r}(y,f)),f&&(y=function(t,e){for(var r=t,n=0;n<e.length;n++){var s=new Function;i(s,r),s.superclass=null,u(s.prototype,e[n].prototype),s.prototype.__mixin__=e[n],r=s}return r}(y,f));var g=n.klassName||"",k=new Function("return function "+g+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return i(k,y),k.superclass=s,k._constructor||(k._constructor=t),f&&(k.__mixins__=f),k.partial||(k.partial=function(t,r){return function(t,r,n){var s=t.prototype,i=t.superclass.prototype,a=n&&n.noOverrided;n&&n.overrides;for(var o in r)if("constructor"!==o){var u=r[o];"function"==typeof r[o]?s[o]=u._constructor||a||"function"!=typeof i[o]?u:function(t,e,r){return function(){var t=this.overrided;this.overrided=r;var n=e.apply(this,arguments);return this.overrided=t,n}}(0,u,i[o]):e.isPlainObject(u)&&null!==u&&u.get?Object.defineProperty(s,o,u):s[o]=u}return t}(this,t,r)}),k.inherit||(k.inherit=function(t,e,n){return r(t,this,e,n)}),k.partial(n,h),k}}();return s.klass=f}),t("skylark-langx-constructs/main",["./constructs","./inherit","./klass"],function(t){return t}),t("skylark-langx-constructs",["skylark-langx-constructs/main"],function(t){return t}),t("skylark-langx-klass/klass",["skylark-langx-ns","skylark-langx-constructs"],function(t,e){return t.attach("langx.klass",e.klass)}),t("skylark-langx-klass/main",["./klass"],function(t){return t}),t("skylark-langx-klass",["skylark-langx-klass/main"],function(t){return t}),t("skylark-langx-hoster/hoster",["skylark-langx-ns"],function(t){var e={isBrowser:!0,isNode:null,global:this,browser:null,node:null};"object"==typeof process&&process.versions&&process.versions.node&&process.versions.v8&&(e.isNode=!0,e.isBrowser=!1),e.global=function(){return"undefined"!=typeof global&&"function"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}();var r=null;if(Object.defineProperty(e,"document",function(){if(!r){var t="undefined"==typeof window?require("html-element"):window;r=t.document}return r}),void 0===e.global.CustomEvent&&(e.global.CustomEvent=function(t,e){this.type=t,this.props=e}),e.isBrowser){var n=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(navigator.userAgent),s=e.browser={};n.browser&&(s[n.browser]=!0,s.version=n.version),s.chrome?s.webkit=!0:s.webkit&&(s.safari=!0)}return e.detects={},t.attach("langx.hoster",e)}),t("skylark-langx-hoster/detects/mobile",["../hoster"],function(t){var e=/iPhone/i,r=/iPod/i,n=/iPad/i,s=/\biOS-universal(?:.+)Mac\b/i,i=/\bAndroid(?:.+)Mobile\b/i,a=/Android/i,o=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,u=/Silk/i,l=/Windows Phone/i,c=/\bWindows(?:.+)ARM\b/i,f=/BlackBerry/i,h=/BB10/i,y=/Opera Mini/i,g=/\b(CriOS|Chrome)(?:.+)Mobile/i,k=/Mobile(?:.+)Firefox\b/i,p=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};return t.detects.mobile=function(t){var d={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?d.userAgent=t:t&&t.userAgent&&(d={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):d={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var m=d.userAgent,v=m.split("[FBAN");void 0!==v[1]&&(m=v[0]);void 0!==(v=m.split("Twitter"))[1]&&(m=v[0]);var b=function(t){return function(e){return e.test(t)}}(m),x={apple:{phone:b(e)&&!b(l),ipod:b(r),tablet:!b(e)&&(b(n)||p(d))&&!b(l),universal:b(s),device:(b(e)||b(r)||b(n)||b(s)||p(d))&&!b(l)},amazon:{phone:b(o),tablet:!b(o)&&b(u),device:b(o)||b(u)},android:{phone:!b(l)&&b(o)||!b(l)&&b(i),tablet:!b(l)&&!b(o)&&!b(i)&&(b(u)||b(a)),device:!b(l)&&(b(o)||b(u)||b(i)||b(a))||b(/\bokhttp\b/i)},windows:{phone:b(l),tablet:b(c),device:b(l)||b(c)},other:{blackberry:b(f),blackberry10:b(h),opera:b(y),firefox:b(k),chrome:b(g),device:b(f)||b(h)||b(y)||b(k)||b(g)},any:!1,phone:!1,tablet:!1};return x.any=x.apple.device||x.android.device||x.windows.device||x.other.device,x.phone=x.apple.phone||x.android.phone||x.windows.phone,x.tablet=x.apple.tablet||x.android.tablet||x.windows.tablet,x}}),t("skylark-langx-hoster/is-mobile",["./hoster","./detects/mobile"],function(t,e){return void 0==t.isMobile&&(t.isMobile=e()),t.isMobile}),t("skylark-langx-hoster/main",["./hoster","./is-mobile"],function(t){return t}),t("skylark-langx-hoster",["skylark-langx-hoster/main"],function(t){return t}),t("skylark-langx-events/event",["skylark-langx-objects","skylark-langx-funcs","skylark-langx-klass","skylark-langx-hoster","./events"],function(t,e,r,n){var s={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function i(r,n){return!n&&r.isDefaultPrevented||(n||(n=r),t.each(s,function(t,s){var i=n[t];r[t]=function(){return this[s]=e.returnTrue,i&&i.apply(n,arguments)},r[s]=e.returnFalse})),r}class a extends CustomEvent{constructor(e,r){super(e,r),t.safeMixin(this,r),i(this)}}return a.compatible=i,n.Event=a}),t("skylark-langx-events/listener",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./event"],function(t,e,r,n,s,i){Array.prototype.slice;var a=r.compact,o=(t.isDefined,t.isUndefined),u=(t.isPlainObject,t.isFunction,t.isBoolean),l=t.isString,c=t.isEmptyObject,f=(e.mixin,e.safeMixin,n({listenTo:function(e,r,n,s,i){if(!e)return this;if(t.isPlainObject(r)){t.isBoolean(n)?(i=n,n=null):t.isBoolean(s)&&(i=s);var a=r;for(var c in a){var f=c.match(/^([\w:-]*)\s*(.*)$/),h=f[1],y=f[2]||n;y?this.listenTo(e,h,y,a[c],i):this.listenTo(e,h,a[c],i)}return this}u(s)?(i=s,s=n,n=null):u(n)?(i=n,s=n=null):o(s)&&(i=!1,s=n,n=null),s||(s="handleEvent"),l(s)&&(s=this[s]);var g=this.ensureListenedEmitter(e);i?n?g.one(r,n,s,this):g.one(r,s,this):n?g.on(r,n,s,this):g.on(r,s,this);for(var k,p=this._listeningTo||(this._listeningTo=[]),d=0;d<p.length;d++)if(p[d].obj==e){k=p[d];break}k||p.push(k={obj:e,events:{}});var m=k.events,v=m[r]=m[r]||[];return-1==v.indexOf(s)&&v.push(s),this},listenToOnce:function(t,e,r,n){return this.listenTo(t,e,r,n,1)},unlistenTo:function(t,e,r){var n=this._listeningTo;if(!n)return this;l(r)&&(r=this[r]);for(var s=0;s<n.length;s++){var i=n[s];if(!t||t==i.obj){var o=i.events;for(var u in o)if(!e||e==u){var f=o[u];if(f){for(var h=0;h<f.length;h++)if(!r||r==f[s]){let t=this.ensureListenedEmitter(i.obj);t.off(u,f[s],this),f[s]=null}f=o[u]=a(f),c(f)&&(o[u]=null)}}c(o)&&(n[s]=null)}}return n=this._listeningTo=a(n),c(n)&&(this._listeningTo=null),this},ensureListenedEmitter:function(t){return t}}));return s.Listener=f}),t("skylark-langx-events/emitter",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./event","./listener"],function(t,e,r,n,s,i,a){var o=Array.prototype.slice,u=r.compact,l=t.isDefined,c=t.isPlainObject,f=t.isFunction,h=t.isString,y=(t.isEmptyObject,e.mixin);e.safeMixin;function g(t){var e=(""+t).split(".");return{name:e[0],ns:e.slice(1).join(" ")}}var k=new Map,p=a.inherit({_prepareArgs:function(t,e){return e=l(e)?[t].concat(e):[t]},on:function(t,e,r,n,s,i){var a=this,o=this._hub||(this._hub={});if(c(t))return s=n,each(t,function(t,n){a.on(t,e,r,n,s,i)}),this;if(h(e)||f(n)||(s=n,n=r,r=e,e=void 0),f(r)&&(s=n,n=r,r=null),!n)throw new Error("No callback function");if(!f(n))throw new Error("The callback  is not afunction");return h(t)&&(t=t.split(/\s/)),t.forEach(function(t){var a=g(t),u=a.name,l=a.ns;(o[u]||(o[u]=[])).push({fn:n,selector:e,data:r,ctx:s,ns:l,one:i})}),this},one:function(t,e,r,n,s){return this.on(t,e,r,n,s,1)},emit:function(t){if(!this._hub)return this;var e=this;h(t)&&(t=new i(t)),Object.defineProperty(t,"target",{value:this});var r=o.call(arguments,1);return r=this._prepareArgs(t,r),[t.type||t.name,"all"].forEach(function(n){var s=g(n),i=s.name,a=s.ns,o=e._hub[i];if(o){for(var l=o.length,f=!1,h=0;h<l;h++){if(t.isImmediatePropagationStopped&&t.isImmediatePropagationStopped())return this;var k=o[h];(!a||k.ns&&k.ns.startsWith(a))&&(k.data&&(t.data=y({},k.data,t.data)),2==r.length&&c(r[1])&&(t.data=t.data||{},y(t.data,r[1])),k.fn.apply(k.ctx,r),k.one&&(o[h]=null,f=!0))}f&&(e._hub[n]=u(o))}}),this},queueEmit:function(t){const e=t.type||t;let r=k.get(this);r||(r=new Map,k.set(this,r));const n=r.get(e);r.delete(e),window.clearTimeout(n);const s=window.setTimeout(()=>{0===r.size&&(r=null,k.delete(this)),this.trigger(t)},0);r.set(e,s)},listened:function(t){var e=(this._hub||(this._events={}))[t]||[];return e.length>0},off:function(t,e){if(t){var r=this._hub||(this._hub={});return h(t)&&(t=t.split(/\s/)),t.forEach(function(t){var n=g(t),s=n.name,i=n.ns,a=r[s];if(a){var o=[];if(e||i)for(var u=0,l=a.length;u<l;u++)e&&a[u].fn!==e&&a[u].fn._!==e?o.push(a[u]):!i||a[u].ns&&0==a[u].ns.indexOf(i)||o.push(a[u]);o.length?r[s]=o:delete r[s]}}),this}this._hub=null},trigger:function(){return this.emit.apply(this,arguments)},queueTrigger:function(t){return this.queueEmit.apply(this,arguments)}});return s.Emitter=p}),t("skylark-langx-events/create-event",["./events","./event"],function(t,e){return t.createEvent=function(t,r){return new e(t,r)}}),t("skylark-langx-events/main",["./events","./event","./listener","./emitter","./create-event"],function(t){return t}),t("skylark-langx-events",["skylark-langx-events/main"],function(t){return t}),t("skylark-io-streams/decode-stream",["skylark-langx-events","skylark-langx-chars","./streams"],function(t,e,r){var n=new Uint8Array(0),s=t.Emitter.inherit({klassName:"DecodeStream",_construct:function(t){if(this._rawMinBufferLength=t||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=n,this.minBufferLength=512,t)for(;this.minBufferLength<t;)this.minBufferLength*=2},length:{get:function(){throw new Error("Should not access DecodeStream.length")}},isEmpty:{get:function(){for(;!this.eof&&0===this.bufferLength;)this.readBlock();return 0===this.bufferLength}},ensureBuffer:function(t){var e=this.buffer;if(t<=e.byteLength)return e;for(var r=this.minBufferLength;r<t;)r*=2;var n=new Uint8Array(r);return n.set(e),this.buffer=n},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]},getUint16:function(){var t=this.getByte(),e=this.getByte();return-1===t||-1===e?-1:(t<<8)+e},getInt32:function(){var t=this.getByte(),e=this.getByte(),r=this.getByte(),n=this.getByte();return(t<<24)+(e<<16)+(r<<8)+n},getBytes(t,e=!1){var r,n=this.pos;if(t){for(this.ensureBuffer(n+t),r=n+t;!this.eof&&this.bufferLength<r;)this.readBlock();var s=this.bufferLength;r>s&&(r=s)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}this.pos=r;const i=this.buffer.subarray(n,r);return!e||i instanceof Uint8ClampedArray?i:new Uint8ClampedArray(i)},peekByte:function(){var t=this.getByte();return-1!==t&&this.pos--,t},peekBytes(t,e=!1){var r=this.getBytes(t,e);return this.pos-=r.length,r},makeSubStream:function(t,e,r){for(var n=t+e;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,e,r)},getByteRange(t,e){throw new Error("Should not call DecodeStream.getByteRange")},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0},getBaseStreams:function(){return this.str&&this.str.getBaseStreams?this.str.getBaseStreams():[]}});return r.DecodeStream=s}),t("skylark-io-streams/ascii85-stream",["skylark-langx-chars","./streams","./decode-stream"],function(t,e,r){var n=r.inherit({klassName:"Ascii85Stream",_construct:function(t){this.str=t,this.dict=t.dict,this.input=new Uint8Array(5),maybeLength&&(maybeLength*=.8),r.prototype._construct.call(this,maybeLength)},readBlock:function(){for(var e=this.str,r=e.getByte();t.isWhiteSpace(r);)r=e.getByte();if(-1!==r&&126!==r){var n,s,i=this.bufferLength;if(122===r){for(n=this.ensureBuffer(i+4),s=0;s<4;++s)n[i+s]=0;this.bufferLength+=4}else{var a=this.input;for(a[0]=r,s=1;s<5;++s){for(r=e.getByte();t.isWhiteSpace(r);)r=e.getByte();if(a[s]=r,-1===r||126===r)break}if(n=this.ensureBuffer(i+s-1),this.bufferLength+=s-1,s<5){for(;s<5;++s)a[s]=117;this.eof=!0}var o=0;for(s=0;s<5;++s)o=85*o+(a[s]-33);for(s=3;s>=0;--s)n[i+s]=255&o,o>>=8}}else this.eof=!0}});return e.Ascii85Stream=n}),t("skylark-io-streams/ascii-hex-stream",["./streams","./decode-stream"],function(t,e){var r=e.inherit({klassName:"AsciiHexStream",_construct:function(t,r){this.str=t,this.dict=t.dict,this.firstDigit=-1,r&&(r*=.5),e.prototype._construct.call(this,r)},readBlock:function(){var t=this.str.getBytes(8e3);if(t.length){for(var e=t.length+1>>1,r=this.ensureBuffer(this.bufferLength+e),n=this.bufferLength,s=this.firstDigit,i=0,a=t.length;i<a;i++){var o,u=t[i];if(u>=48&&u<=57)o=15&u;else{if(!(u>=65&&u<=70||u>=97&&u<=102)){if(62===u){this.eof=!0;break}continue}o=9+(15&u)}s<0?s=o:(r[n++]=s<<4|o,s=-1)}s>=0&&this.eof&&(r[n++]=s<<4,s=-1),this.firstDigit=s,this.bufferLength=n}else this.eof=!0}});return t.AsciiHexStream=r}),t("skylark-io-streams/_stream",["skylark-langx-events","./streams"],function(t,e){var r=t.Emitter.inherit({klassName:"Stream",_construct:function(t,e,r,n){this.bytes=t instanceof Uint8Array?t:new Uint8Array(t),this.start=e||0,this.pos=this.start,this.end=e+r||this.bytes.length,this.dict=n},length:{get:function(){return this.end-this.start}},getByte:function(){return this.pos>=this.end?-1:this.bytes[this.pos++]},getUint16:function(){var t=this.getByte(),e=this.getByte();return-1===t||-1===e?-1:(t<<8)+e},getInt32:function(){var t=this.getByte(),e=this.getByte(),r=this.getByte(),n=this.getByte();return(t<<24)+(e<<16)+(r<<8)+n},getBytes(t,e=!1){var r=this.bytes,n=this.pos,s=this.end;if(!t){const t=r.subarray(n,s);return e?new Uint8ClampedArray(t):t}var i=n+t;i>s&&(i=s),this.pos=i;const a=r.subarray(n,i);return e?new Uint8ClampedArray(a):a},peekByte:function(){var t=this.getByte();return-1!==t&&this.pos--,t},peekBytes(t,e=!1){var r=this.getBytes(t,e);return this.pos-=r.length,r},getByteRange(t,e){return t<0&&(t=0),e>this.end&&(e=this.end),this.bytes.subarray(t,e)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(t,e,n){return new r(this.bytes.buffer,t,e,n)}});return e.Stream=r}),t("skylark-io-streams/chunked-stream",["./streams","./_stream"],function(t,e){var r=e.inherit({klassName:"ChunkedStream",numChunks:0,numChunksLoaded:0,_construct:function(t){for(var e=t.length,r=new Uint8Array(e),n=0;n<e;++n)r[n]=t.charCodeAt(n);DecodeStream.prototype._construct.call(r),this.dict=stream.dict},numChunks:function(){},getMissingChunks:function(){for(var t=[],e=0,r=this.numChunks;e<r;++e)e in this.loadedChunks||t.push(e);return t},getBaseStreams:function(){return[this]},allChunksLoaded:function(){var t=this._;return t.numChunksLoaded===t.numChunks},onReceiveData:function(t,e){var r=t+e.byteLength;assert(t%this.chunkSize==0,"Bad begin offset: "+t);var n=this.bytes.length;assert(r%this.chunkSize==0||r===n,"Bad end offset: "+r),this.bytes.set(new Uint8Array(e),t);for(var s=this.chunkSize,i=Math.floor(t/s),a=Math.floor((r-1)/s)+1,e=i;e<a;++e)e in this.loadedChunks||(this.loadedChunks[e]=!0,++this.numChunksLoaded)},onReceiveInitialData:function(t){this.bytes.set(t),this.initialDataLength=t.length;for(var e=this.end===t.length?this.numChunks:Math.floor(t.length/this.chunkSize),r=0;r<e;r++)this.loadedChunks[r]=!0,++this.numChunksLoaded},ensureRange:function(t,e){if(!(t>=e||e<=this.initialDataLength))for(var r=this.chunkSize,n=Math.floor(t/r),s=Math.floor((e-1)/r)+1,i=n;i<s;++i)if(!(i in this.loadedChunks))throw new MissingDataException(t,e)},nextEmptyChunk:function(t){for(var e=t,r=this.numChunks;e<r;++e)if(!(e in this.loadedChunks))return e;for(var e=0;e<t;++e)if(!(e in this.loadedChunks))return e;return null},hasChunk:function(t){return t in this._.loadedChunks},getByte:function(){var t=this.pos;return t>=this.end?-1:(this.ensureRange(t,t+1),this.bytes[this.pos++])},getBytes:function(t){var e=this.bytes,r=this.pos,n=this.end;if(!t)return this.ensureRange(r,n),e.subarray(r,n);var s=r+t;return s>n&&(s=n),this.ensureRange(r,s),this.pos=s,e.subarray(r,s)},peekBytes:function(t){var e=this.getBytes(t);return this.pos-=e.length,e},getByteRange:function(t,e){return this.ensureRange(t,e),this.bytes.subarray(t,e)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(t,e,r){function n(){}n.prototype=Object.create(this),n.prototype.getMissingChunks=function(){for(var t=this.chunkSize,e=Math.floor(this.start/t),r=Math.floor((this.end-1)/t)+1,n=[],s=e;s<r;++s)s in this.loadedChunks||n.push(s);return n};var s=new n;return s.pos=s.start=t,s.end=t+e||this.end,s.dict=r,s}});return t.ChunkedStream=r}),t("skylark-io-streams/decrypt-stream",["./streams","./decode-stream"],function(t,e){var r=e.inherit({klassName:"DecryptStream",_construct:function(t,r,n){this.str=t,this.dict=t.dict,this.decrypt=n,this.nextChunk=null,this.initialized=!1,e.prototype._construct.call(this,r)},readBlock:function(){var t;if(this.initialized?t=this.nextChunk:(t=this.str.getBytes(512),this.initialized=!0),t&&0!==t.length){this.nextChunk=this.str.getBytes(512);var e=this.nextChunk&&this.nextChunk.length>0,r=this.decrypt;t=r(t,!e);var n,s=this.bufferLength,i=t.length,a=this.ensureBuffer(s+i);for(n=0;n<i;n++)a[s++]=t[n];this.bufferLength=s}else this.eof=!0}});return t.DecryptStream=r}),t("skylark-io-streams/fake-stream",["./streams","./decode-stream"],function(t,e){var r=e.inherit({klassName:"FakeStream",_construct:function(t){this.dict=t.dict,e.prototype._construct.call(this)},readBlock:function(){var t=this.bufferLength;t+=1024;this.ensureBuffer(t);this.bufferLength=t},getBytes:function(t){var e,r=this.pos;if(t){for(this.ensureBuffer(r+t),e=r+t;!this.eof&&this.bufferLength<e;)this.readBlock();var n=this.bufferLength;e>n&&(e=n)}else this.eof=!0,e=this.bufferLength;return this.pos=e,this.buffer.subarray(r,e)}});return t.FakeStream=r}),t("skylark-io-streams/flate-stream",["./streams","./decode-stream"],function(t,e){var r=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),s=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),i=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],a=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5],o=e.inherit({klassName:"FlateStream",_construct:function(t,r){this.str=t,this.dict=t.dict;var n=t.getByte(),s=t.getByte();if(-1===n||-1===s)throw new util.FormatError(`Invalid header in flate stream: ${n}, ${s}`);if(8!=(15&n))throw new util.FormatError(`Unknown compression method in flate stream: ${n}, ${s}`);if(((n<<8)+s)%31!=0)throw new util.FormatError(`Bad FCHECK in flate stream: ${n}, ${s}`);if(32&s)throw new util.FormatError(`FDICT bit set in flate stream: ${n}, ${s}`);this.codeSize=0,this.codeBuf=0,e.prototype._construct.call(this,r)},getBits:function(t){for(var e,r=this.str,n=this.codeSize,s=this.codeBuf;n<t;){if(-1===(e=r.getByte()))throw new util.FormatError("Bad encoding in flate stream");s|=e<<n,n+=8}return e=s&(1<<t)-1,this.codeBuf=s>>t,this.codeSize=n-=t,e},getCode:function(t){for(var e,r=this.str,n=t[0],s=t[1],i=this.codeSize,a=this.codeBuf;i<s&&-1!==(e=r.getByte());)a|=e<<i,i+=8;var o=n[a&(1<<s)-1],u=o>>16,l=65535&o;if(u<1||i<u)throw new util.FormatError("Bad encoding in flate stream");return this.codeBuf=a>>u,this.codeSize=i-u,l},generateHuffmanTable:function(t){var e,r=t.length,n=0;for(e=0;e<r;++e)t[e]>n&&(n=t[e]);for(var s=1<<n,i=new Int32Array(s),a=1,o=0,u=2;a<=n;++a,o<<=1,u<<=1)for(var l=0;l<r;++l)if(t[l]===a){var c=0,f=o;for(e=0;e<a;++e)c=c<<1|1&f,f>>=1;for(e=c;e<s;e+=u)i[e]=a<<16|l;++o}return[i,n]},readBlock:function(){var t,e,o=this.str,u=this.getBits(3);if(1&u&&(this.eof=!0),0!==(u>>=1)){var l,c;if(1===u)l=i,c=a;else{if(2!==u)throw new util.FormatError("Unknown block type in flate stream");var f,h=this.getBits(5)+257,y=this.getBits(5)+1,g=this.getBits(4)+4,k=new Uint8Array(r.length);for(f=0;f<g;++f)k[r[f]]=this.getBits(3);var p=this.generateHuffmanTable(k);e=0,f=0;for(var d,m,v,b=h+y,x=new Uint8Array(b);f<b;){var w=this.getCode(p);if(16===w)d=2,m=3,v=e;else if(17===w)d=3,m=3,v=e=0;else{if(18!==w){x[f++]=e=w;continue}d=7,m=11,v=e=0}for(var B=this.getBits(d)+m;B-- >0;)x[f++]=v}l=this.generateHuffmanTable(x.subarray(0,h)),c=this.generateHuffmanTable(x.subarray(h,b))}for(var j=(t=this.buffer)?t.length:0,_=this.bufferLength;;){var S=this.getCode(l);if(S<256)_+1>=j&&(t=this.ensureBuffer(_+1),j=t.length),t[_++]=S;else{if(256===S)return void(this.bufferLength=_);var A=(S=n[S-=257])>>16;A>0&&(A=this.getBits(A)),e=(65535&S)+A,S=this.getCode(c),S=s[S],(A=S>>16)>0&&(A=this.getBits(A));var L=(65535&S)+A;_+e>=j&&(t=this.ensureBuffer(_+e),j=t.length);for(var C=0;C<e;++C,++_)t[_]=t[_-L]}}}else{var E;if(-1===(E=o.getByte()))throw new util.FormatError("Bad block header in flate stream");var O=E;if(-1===(E=o.getByte()))throw new util.FormatError("Bad block header in flate stream");if(O|=E<<8,-1===(E=o.getByte()))throw new util.FormatError("Bad block header in flate stream");var T=E;if(-1===(E=o.getByte()))throw new util.FormatError("Bad block header in flate stream");if((T|=E<<8)!==(65535&~O)&&(0!==O||0!==T))throw new util.FormatError("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;const e=this.bufferLength,r=e+O;if(t=this.ensureBuffer(r),this.bufferLength=r,0===O)-1===o.peekByte()&&(this.eof=!0);else{const r=o.getBytes(O);t.set(r,e),r.length<O&&(this.eof=!0)}}}});return t.FlateStream=o}),t("skylark-io-streams/lzw-stream",["./streams","./decode-stream"],function(t,e){var r=e.inherit({klassName:"LZWStream",_construct:function(t,r,n){this.str=t,this.dict=t.dict,this.cachedData=0,this.bitsCached=0;for(var s={earlyChange:n,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(4096),dictionaryLengths:new Uint16Array(4096),dictionaryPrevCodes:new Uint16Array(4096),currentSequence:new Uint8Array(4096),currentSequenceLength:0},i=0;i<256;++i)s.dictionaryValues[i]=i,s.dictionaryLengths[i]=1;this.lzwState=s,e.prototype._construct.call(this,r)},readBits:function(t){for(var e=this.bitsCached,r=this.cachedData;e<t;){var n=this.str.getByte();if(-1===n)return this.eof=!0,null;r=r<<8|n,e+=8}return this.bitsCached=e-=t,this.cachedData=r,this.lastCode=null,r>>>e&(1<<t)-1},readBlock:function(){var t,e,r,n=1024,s=this.lzwState;if(s){var i=s.earlyChange,a=s.nextCode,o=s.dictionaryValues,u=s.dictionaryLengths,l=s.dictionaryPrevCodes,c=s.codeLength,f=s.prevCode,h=s.currentSequence,y=s.currentSequenceLength,g=0,k=this.bufferLength,p=this.ensureBuffer(this.bufferLength+n);for(t=0;t<512;t++){var d=this.readBits(c),m=y>0;if(d<256)h[0]=d,y=1;else{if(!(d>=258)){if(256===d){c=9,a=258,y=0;continue}this.eof=!0,delete this.lzwState;break}if(d<a)for(y=u[d],e=y-1,r=d;e>=0;e--)h[e]=o[r],r=l[r];else h[y++]=h[0]}if(m&&(l[a]=f,u[a]=u[f]+1,o[a]=h[0],c=++a+i&a+i-1?c:0|Math.min(Math.log(a+i)/.6931471805599453+1,12)),f=d,n<(g+=y)){do{n+=512}while(n<g);p=this.ensureBuffer(this.bufferLength+n)}for(e=0;e<y;e++)p[k++]=h[e]}s.nextCode=a,s.codeLength=c,s.prevCode=f,s.currentSequenceLength=y,this.bufferLength=k}}});return t.LZWStream=r}),t("skylark-io-streams/null-stream",["./streams","./_stream"],function(t,e){var r=e.inherit({klassName:"NullStream",_construct:function(){e.prototype._construct.call(this,new Uint8Array(0))}});return t.NullStream=r}),t("skylark-io-streams/predictor-stream",["./streams","./decode-stream"],function(t,e){var r=e.inherit({klassName:"PredictorStream",_construct:function(t,r,n){if(!primitives.isDict(n))return t;var s=this.predictor=n.get("Predictor")||1;if(s<=1)return t;if(2!==s&&(s<10||s>15))throw new Error(`Unsupported predictor: ${s}`);this.readBlock=2===s?this.readBlockTiff:this.readBlockPng,this.str=t,this.dict=t.dict;var i=this.colors=n.get("Colors")||1,a=this.bits=n.get("BitsPerComponent")||8,o=this.columns=n.get("Columns")||1;return this.pixBytes=i*a+7>>3,this.rowBytes=o*i*a+7>>3,e.call(this,r),this},readBlockTiff:function(){var t=this.rowBytes,e=this.bufferLength,r=this.ensureBuffer(e+t),n=this.bits,s=this.colors,i=this.str.getBytes(t);if(this.eof=!i.length,!this.eof){var a,o=0,u=0,l=0,c=0,f=e;if(1===n&&1===s)for(a=0;a<t;++a){var h=i[a]^o;h^=h>>1,h^=h>>2,o=(1&(h^=h>>4))<<7,r[f++]=h}else if(8===n){for(a=0;a<s;++a)r[f++]=i[a];for(;a<t;++a)r[f]=r[f-s]+i[a],f++}else if(16===n){var y=2*s;for(a=0;a<y;++a)r[f++]=i[a];for(;a<t;a+=2){var g=((255&i[a])<<8)+(255&i[a+1])+((255&r[f-y])<<8)+(255&r[f-y+1]);r[f++]=g>>8&255,r[f++]=255&g}}else{var k=new Uint8Array(s+1),p=(1<<n)-1,d=0,m=e,v=this.columns;for(a=0;a<v;++a)for(var b=0;b<s;++b)l<n&&(o=o<<8|255&i[d++],l+=8),k[b]=k[b]+(o>>l-n)&p,l-=n,u=u<<n|k[b],(c+=n)>=8&&(r[m++]=u>>c-8&255,c-=8);c>0&&(r[m++]=(u<<8-c)+(o&(1<<8-c)-1))}this.bufferLength+=t}},readBlockPng:function(){var t=this.rowBytes,e=this.pixBytes,r=this.str.getByte(),n=this.str.getBytes(t);if(this.eof=!n.length,!this.eof){var s=this.bufferLength,i=this.ensureBuffer(s+t),a=i.subarray(s-t,s);0===a.length&&(a=new Uint8Array(t));var o,u,l,c=s;switch(r){case 0:for(o=0;o<t;++o)i[c++]=n[o];break;case 1:for(o=0;o<e;++o)i[c++]=n[o];for(;o<t;++o)i[c]=i[c-e]+n[o]&255,c++;break;case 2:for(o=0;o<t;++o)i[c++]=a[o]+n[o]&255;break;case 3:for(o=0;o<e;++o)i[c++]=(a[o]>>1)+n[o];for(;o<t;++o)i[c]=(a[o]+i[c-e]>>1)+n[o]&255,c++;break;case 4:for(o=0;o<e;++o)u=a[o],l=n[o],i[c++]=u+l;for(;o<t;++o){u=a[o];var f=a[o-e],h=i[c-e],y=h+u-f,g=y-h;g<0&&(g=-g);var k=y-u;k<0&&(k=-k);var p=y-f;p<0&&(p=-p),l=n[o],i[c++]=g<=k&&g<=p?h+l:k<=p?u+l:f+l}break;default:throw new Error(`Unsupported predictor: ${r}`)}this.bufferLength+=t}}});return t.PredictorStream=r}),t("skylark-io-streams/run-length-stream",["skylark-langx-chars","./streams","./decode-stream"],function(t,e,r){var n=r.inherit({klassName:"RunLengthStream",_construct:function(t,e){this.str=t,this.dict=t.dict,r.prototype._construct.call(this,e)},readBlock:function(){var t=this.str.getBytes(2);if(!t||t.length<2||128===t[0])this.eof=!0;else{var e,r=this.bufferLength,n=t[0];if(n<128){if((e=this.ensureBuffer(r+n+1))[r++]=t[1],n>0){var s=this.str.getBytes(n);e.set(s,r),r+=n}}else{n=257-n;var i=t[1];e=this.ensureBuffer(r+n+1);for(var a=0;a<n;a++)e[r++]=i}this.bufferLength=r}}});return e.RunLengthStream=n}),t("skylark-io-streams/streams-sequence-stream",["skylark-langx-chars","./streams","./decode-stream"],function(t,e,r){var n=r.inherit({klassName:"StreamsSequenceStream",_construct:function(t){this.streams=t;let e=0;for(let n=0,s=t.length;n<s;n++){const s=t[n];e+=s instanceof r?s._rawMinBufferLength:s.length}r.prototype._construct.call(this,e)},readBlock:function(){var t=this.streams;if(0!==e.length){var r=t.shift(),n=r.getBytes(),s=this.bufferLength,i=s+n.length,a=this.ensureBuffer(i);a.set(n,s),this.bufferLength=i}else this.eof=!0},getBaseStreams:function(){for(var t=[],e=0,r=this.streams.length;e<r;e++){var n=this.streams[e];n.getBaseStreams&&t.push(...n.getBaseStreams())}return t}});return e.StreamsSequenceStream=n}),t("skylark-io-streams/string-stream",["./streams","./_stream"],function(t,e){var r=e.inherit({klassName:"StringStream",_construct:function(t){for(var r=t.length,n=new Uint8Array(r),s=0;s<r;++s)n[s]=t.charCodeAt(s);e.prototype._construct.call(this,n)}});return t.StringStream=r}),t("skylark-io-streams/main",["./streams","./ascii85-stream","./ascii-hex-stream","./chunked-stream","./decode-stream","./decrypt-stream","./fake-stream","./flate-stream","./lzw-stream","./null-stream","./predictor-stream","./run-length-stream","./_stream","./streams-sequence-stream","./string-stream"],function(t){return t}),t("skylark-io-streams",["skylark-io-streams/main"],function(t){return t})}(r,require),!n){var a=require("skylark-langx-ns");s?module.exports=a:e.skylarkjs=a}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-io-streams-all.js.map
